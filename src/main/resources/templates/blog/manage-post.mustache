{{>layout/manage/manage-top}}

<style>
    .post-btns {
        background-color: white;
        font-size: 10pt;
        border: 1px solid #636464;
        padding: 4px 10px;
        margin-left: 10px;
        visibility: hidden;
    }
    .post-btns:hover {
        border:1px solid #1c1f23;
        background-color: #636464;
        color: white;
    }
</style>

<div class="row justify-content-center">
    <div class="col-12">
        <h5 class="" style="display: inline">글 관리</h5>
        <button class="btn float-end btn-outline-dark btn-sm" style="border-radius: 0px;">글 쓰기</button>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div style="margin-top: 8px; width: 100%; height: 52px; background-color: #F1F2F3; border: 1px solid #DDDDDD;">
            <button class="btn float-end" style="font-size: 10pt; margin-right: 10px; margin-top: 8px;">
                검색&nbsp;&nbsp;
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                </svg>
            </button>
        </div>
    </div>
</div>
<div class="row align-content-center" style="margin-top: 8px;">
    <div class="col-12">
        <div style="width: 100%; border: 1px solid #DDDDDD; border-top: none;">
            {{#blog.posts}}
            <div id="post-item-{{id}}" style="padding: 22px; background-color: white; border-top: 1px solid #DDDDDD;">
                <div class="row align-content-center">
                    <div class="col-8">
                        <a href="#" style="margin-bottom: 4px; padding-bottom: 0; color: #2c3034; font-size: 13pt;">{{title}}</a>
                        <div>
                            <a style="font-size: 10pt; color: #FF5010; margin: 0 18px 0 0; padding: 0; display: inline;">{{category}}</a>
                            <p style="font-size: 10pt; color: #888888; margin: 0 18px 0 0; padding: 0; display: inline;">{{userNickname}}</p>
                            <p style="font-size: 10pt; color: #888888; margin: 0 18px 0 0; padding: 0; display: inline;">작성 날짜</p>
                        </div>
                    </div>
                    <div class="col-4" style="padding-top: 8px;">
                        <button id="post-item-btn-delete-{{id}}" class="post-btns float-end">삭제</button>
                        <button id="post-item-btn-modify-{{id}}" class="post-btns float-end">수정</button>
                        <button id="post-item-btn-security-{{id}}" class="post-btns float-end" onclick="btnSecurity(this.id)">{{security}}</button>
                    </div>
                </div>
            </div>
            {{/blog.posts}}
        </div>
    </div>
</div>

<script>
    // 카테고리 템플릿 마우스 올림/내림 이벤트 정의
    $(function (){
        {{#blog.posts}}
        $('#post-item-'+{{id}}).mouseover(() => {
            $("#post-item-btn-security-"+{{id}}).css("visibility", "visible");
            $("#post-item-btn-modify-"+{{id}}).css("visibility", "visible");
            $("#post-item-btn-delete-"+{{id}}).css("visibility", "visible");
        });
        $('#post-item-'+{{id}}).mouseleave(() => {
            $("#post-item-btn-security-"+{{id}}).css("visibility", "hidden");
            $("#post-item-btn-modify-"+{{id}}).css("visibility", "hidden");
            $("#post-item-btn-delete-"+{{id}}).css("visibility", "hidden");
        });
        {{/blog.posts}}
    });

    // 글 공개/비공개 변경
    function btnSecurity(id) {
        let security = $('#'+id).text();
        let postId = Number(id.charAt(id.length - 1)); // post id

        if(security == "공개") {
            security = String("비공개");
        } else {
            security = String("공개");
        }

        let json = JSON.stringify({"security":security, "id":postId});

        $.ajax({
            type:"put",
            url:'/{{blog.url}}/manage/post/security',
            data:json,
            contentType:"application/json; charset=utf-8",
            dataType:"json"
        }).done(res=>{
            $('#'+id).text(security);
        }).fail(error=>{
            alert(JSON.stringify(error));
        });

    }
</script>

{{>layout/manage/manage-bottom}}